## 선언적 트랜잭션 관리

### 1. 특징

스프링에서는 많은 개발자들이 선언적 트랜잭션 관리 방식을 사용한다. 이 방식은 트랜잭션 처리 로직을 직접 작성하지 않고, 설정이나 어노테이션을 통해 간편하게 적용할 수 있어 코드가 매우 깔끔해진다. AOP 기반 프록시를 통해 메서드 호출 시점에 트랜잭션을 적용하며, 클래스나 메서드 단위로 트랜잭션을 설정할 수 있다.

### 2. 장점

1. **특정 트랜잭션 기술에 종속되지 않음**
    
    JDBC, JPA, Hibernate 등 어떤 기술을 사용하든 동일한 방식으로 트랜잭션을 설정할 수 있으며, 구현체를 변경하더라도 설정만 바꾸면 되기 때문에 코드에는 영향을 주지 않는다.
    
2. **특별한 형태의 클래스가 필요하지 않음**
    
    일반 클래스나 메서드 어디든 `@Transactional` 애너테이션을 붙이는 것만으로 트랜잭션을 적용할 수 있다.
    
3. **트랜잭션 코드와 비즈니스 로직 분리**
    
    선언적 방식은 비즈니스 로직 코드 내부에 트랜잭션 관련 로직이 들어가지 않기 때문에 핵심 로직 자체에만 집중할 수 있다.
    

### 3. 단점

선언적 트랜잭션은 AOP 기반으로 동작하기 때문에 원격 호출 간에 트랜잭션 컨텍스트를 자동으로 전파하는 기능은 제공하지 않는다. 이런 경우에는 여전히 EJB와 같은 고급 트랜잭션 기술이 필요하다.

### 4. 롤백

기본적으로 `RuntimeException`이나 `Error`가 발생하면 트랜잭션이 자동으로 롤백된다. 반면 일반적인 `CheckedException`의 경우에는 자동으로 롤백되지 않는다.

이러한 동작을 개발자가 직접 제어하고 싶을 때는 `@Transactional` 애너테이션의 `rollbackFor` 속성을 사용하면 된다. 이 속성을 사용하면 특정 예외 클래스에 대해 롤백 여부를 선언적으로 지정할 수 있다. 예를 들어 다음과 같이 `MyCustomException`이 발생했을 때도 롤백되도록 설정할 수 있다.

```java
@Transactional(rollbackFor = MyCustomException.class)
public void process() {
  ...
}
```

또한 AOP를 활용해 트랜잭션 롤백이 발생하는 경우 로깅을 남기나 별도의 후처리를 하는 등의 작업을 추가할 수 있다.